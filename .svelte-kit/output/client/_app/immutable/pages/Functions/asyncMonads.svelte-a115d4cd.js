import{S as we,i as Ie,s as Te,a as A,l as u,r as m,K as ke,h as t,c as O,m as p,n as h,u as y,q as de,p as me,b as i,G as v,v as Fe,M as Se,N as Ee,o as $e}from"../../chunks/index-cac77216.js";import{f as Pe}from"../../chunks/index-54fd7bcd.js";function je(l){let P,R,M,b,S,T,a,E,w,o,d,$,I,x,C,k,K,V,s,f,c,n,_,L,D,z,fe,H,N,ie,W,j,oe,G,Q,U,X,Y,Z,g,ee,F,le,B,ae,ue,te,J,pe,q;return{c(){P=A(),R=u("br"),M=A(),b=u("div"),S=m("**************************************************************************"),T=A(),a=u("div"),E=u("br"),w=m(`
	Asynchronous Functions for the Very Simple Recursive Closure`),d=A(),$=u("br"),I=A(),x=u("p"),C=m("M, defined in "),k=u("a"),K=m("monads"),V=m(", has an extra line of code here to account for possible asynchronisity. Here's the tweaked definition:"),s=A(),f=u("pre"),c=m(l[3]),n=A(),_=u("p"),L=m("This code:"),D=A(),z=u("pre"),fe=m(l[2]),H=A(),N=u("p"),ie=m("Results in this:"),W=A(),j=u("p"),oe=m("Progression of AR: "),G=m(l[0]),Q=A(),U=u("br"),X=u("br"),Y=A(),Z=u("br"),g=u("br"),ee=A(),F=u("p"),le=m("In "),B=u("a"),ae=m("Monad3"),ue=m(" the demonstration used this monad:"),te=A(),J=u("pre"),pe=m(l[1]),this.h()},l(e){ke('[data-svelte="svelte-1szte9y"]',document.head).forEach(t),P=O(e),R=p(e,"BR",{}),M=O(e),b=p(e,"DIV",{});var _e=h(b);S=y(_e,"**************************************************************************"),_e.forEach(t),T=O(e),a=p(e,"DIV",{style:!0});var ce=h(a);E=p(ce,"BR",{}),w=y(ce,`
	Asynchronous Functions for the Very Simple Recursive Closure`),ce.forEach(t),d=O(e),$=p(e,"BR",{}),I=O(e),x=p(e,"P",{});var se=h(x);C=y(se,"M, defined in "),k=p(se,"A",{href:!0});var Ae=h(k);K=y(Ae,"monads"),Ae.forEach(t),V=y(se,", has an extra line of code here to account for possible asynchronisity. Here's the tweaked definition:"),se.forEach(t),s=O(e),f=p(e,"PRE",{});var Oe=h(f);c=y(Oe,l[3]),Oe.forEach(t),n=O(e),_=p(e,"P",{});var Re=h(_);L=y(Re,"This code:"),Re.forEach(t),D=O(e),z=p(e,"PRE",{});var xe=h(z);fe=y(xe,l[2]),xe.forEach(t),H=O(e),N=p(e,"P",{});var he=h(N);ie=y(he,"Results in this:"),he.forEach(t),W=O(e),j=p(e,"P",{});var ve=h(j);oe=y(ve,"Progression of AR: "),G=y(ve,l[0]),ve.forEach(t),Q=O(e),U=p(e,"BR",{}),X=p(e,"BR",{}),Y=O(e),Z=p(e,"BR",{}),g=p(e,"BR",{}),ee=O(e),F=p(e,"P",{});var ne=h(F);le=y(ne,"In "),B=p(ne,"A",{href:!0,target:!0});var Me=h(B);ae=y(Me,"Monad3"),Me.forEach(t),ue=y(ne," the demonstration used this monad:"),ne.forEach(t),te=O(e),J=p(e,"PRE",{});var be=h(J);pe=y(be,l[1]),be.forEach(t),this.h()},h(){document.title="Asynchronous Recursive Closures",de(a,"font-family","Times New Roman"),de(a,"text-align","center"),de(a,"font-size","32px"),me(k,"href","./Archive/monads"),me(B,"href","/Functions/Archive/Monad3/"),me(B,"target","_blank")},m(e,r){i(e,P,r),i(e,R,r),i(e,M,r),i(e,b,r),v(b,S),i(e,T,r),i(e,a,r),v(a,E),v(a,w),i(e,d,r),i(e,$,r),i(e,I,r),i(e,x,r),v(x,C),v(x,k),v(k,K),v(x,V),i(e,s,r),i(e,f,r),v(f,c),i(e,n,r),i(e,_,r),v(_,L),i(e,D,r),i(e,z,r),v(z,fe),i(e,H,r),i(e,N,r),v(N,ie),i(e,W,r),i(e,j,r),v(j,oe),v(j,G),i(e,Q,r),i(e,U,r),i(e,X,r),i(e,Y,r),i(e,Z,r),i(e,g,r),i(e,ee,r),i(e,F,r),v(F,le),v(F,B),v(B,ae),v(F,ue),i(e,te,r),i(e,J,r),v(J,pe),q=!0},p(e,r){(!q||r[0]&1)&&Fe(G,e[0])},i(e){q||(Se(()=>{o||(o=Ee(a,Pe,{},!0)),o.run(1)}),q=!0)},o(e){o||(o=Ee(a,Pe,{},!1)),o.run(0),q=!1},d(e){e&&t(P),e&&t(R),e&&t(M),e&&t(b),e&&t(T),e&&t(a),e&&o&&o.end(),e&&t(d),e&&t($),e&&t(I),e&&t(x),e&&t(s),e&&t(f),e&&t(n),e&&t(_),e&&t(D),e&&t(z),e&&t(H),e&&t(N),e&&t(W),e&&t(j),e&&t(Q),e&&t(U),e&&t(X),e&&t(Y),e&&t(Z),e&&t(g),e&&t(ee),e&&t(F),e&&t(te),e&&t(J)}}}var re="stop";function ye(l){return function P(R){return R=="stop"?l:(l instanceof Promise?l=l.then(M=>l=R(M)):typeof R=="function"&&(l=R(l)),P)}}function Be(l,P,R){let M;var b,S,T,a=async s=>await s,E=ye(3),w,o=console.log,d;$e(async()=>{o("In start <><><><><><><><><> In start"),w=new WebSocket("wss://schalk.site:3003"),new WebSocket("wss://schalk.site:3002");var s=n=>_=>I(n)(_);function f(n){o("At the top of fact2. a is ",n),w.readyState==1?n instanceof Promise?n.then(_=>w.send(parseInt(_))):w.send(parseInt(n)):setTimeout(()=>f(n),200),w.onmessage=function(_){return console.log("In fact2. e and e.data are",_,_.data),n=JSON.parse(_.data),d.push(n),n=ye(E(re))(L=>n)(re),console.log("OOOOOOOOOOOOOOOOOOOOOOOOOOO a is",n),o("At the end of fact2. a is",n,Array.isArray(n)),n}}setTimeout(()=>o("AR is",d),2e3),o("J and K are",b,S),o("J and K are",b,S),setTimeout(()=>o("Now J and K are",b,S),3e3);var c=()=>{E(I(1))(n=>s(n)(7))(n=>n*2)($(58))(s(2))(I(.025))($(1))(I(7))(f)(n=>36)(f)(n=>888)(x)(f)(n=>[2,3,4])(x)(n=>n=n.concat(5))(x)(C)(f),setTimeout(()=>{E(n=>[3,3,3])(x)(C)(f)},3e3)};c(),setTimeout(()=>c(),5e3)}),o("<@><@><@> <$><$><$> <%><%><%> m3(s)",E(re)),E=ye(3);var $=s=>async f=>{var c;return s=a(s),f=a(f),await s.then(n=>s=parseFloat(n)),await f.then(n=>f=parseFloat(n)),c=s+f,d.push(c),o("in asyncMult j and AR are",c,d),c},I=s=>async f=>{var c;return s=a(s),f=a(f),await s.then(n=>s=parseFloat(n)),await f.then(n=>f=parseFloat(n)),c=s*f,d.push(c),o("in asyncMult j and AR are",c,d),c},x=s=>(d.push(s),s);o("AR is",d),o("$&$&$&$&$&$&  m3(s) is",E(re)),a(9).then(s=>console.log("v == 9",s===9)),o("f(f(7)) == f(7)",a(7).then(s=>a(7).then(f=>s==f)));function C(s){return console.log("  **************  Top of red. arr is",s),s instanceof Promise&&s.then(f=>s=f),Array.isArray(s)&&(s=s.reduce((f,c)=>f*c),console.log("  **************  In red. ar is",s),d.push(s),M()),s}setTimeout(()=>R(0,T=M()),2200),setTimeout(()=>R(0,T=M()),3500);var k=`function Comp ( AR = [] )  {
  var f_, p, run;
  var ar = AR.slice();
  var x = ar.pop();
  return run = (function run (x) {
    if (x === null || x === NaN ||
      x === undefined) x = f_('stop').pop();
    if (x instanceof Filt) {
      var z = ar.pop();
      if (x.filt(z)) x = z; else ar = [];
    }
    else if (x instanceof Promise) x.then(y =>
      {if (y != undefined && typeof y !== "boolean"
        && y === y && y.name !== "f_" && y.name !== "stop" ) {
      ar.push(y);
      diffRender()
    }})
    else if (x != undefined && x === x && x !== false
      && x.name !== "f_" && x.name !== "stop" ) {
      ar.push(x);
      diffRender()
    };
    function f_ (func) {
      if (func === 'stop' || func === 'S') return ar;
      else if (func === 'finish' || func === 'F') return Object.freeze(ar);
      else if (typeof func !== "function") p = func;
      else if (x instanceof Promise) p = x.then(v => func(v));
      else p = func(x);
      return run(p);
    };
    return f_;
  })(x)
}`,K=`m3(asyncMult(1))(x => fMult(x)(7))(v => v*2)(asyncAdd(58))(fMult(2))
(asyncMult(0.025))(asyncAdd(1))(asyncMult(7))(fact2)(v => 36)(fact2)
(v => 888)(asyncId)(fact2)(v => [2,3,4])(asyncId)(v => v = v.concat(5))
(asyncId)(red)(fact2)

setTimeout(() => {m3(v => [3,3,3])(asyncId)(red)(fact2)},3000);

setTimeout(() => L = ar(),2200);
setTimeout(() => L = ar(),3500);
    where ar = () => AR.join(" --> ")
      and AR and other relevant functions are defined below.`,V=`function M(x) {
    return function go(func) {
        if (func == "stop") return x
        if (x instanceof Promise) x = x.then(v => x = func(v));
        else if (typeof func == 'function') x = func(x);
        return go;
    };
}`;return l.$$.update=()=>{l.$$.dirty[0]&16&&(M=()=>d.join(" --> "))},R(4,d=[]),[T,k,K,V,d]}class Ne extends we{constructor(P){super(),Ie(this,P,Be,je,Te,{},null,[-1,-1])}}export{Ne as default};
